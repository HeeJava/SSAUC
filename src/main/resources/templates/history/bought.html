<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout.html">
<head>
  <meta charset="UTF-8">
  <title>구매 내역 상세</title>
  <!-- 스타일시트 연결 -->
  <link rel="stylesheet" href="/css/mypage.css">
  <link rel="stylesheet" href="/css/bought.css">
</head>
<body>

<div class="bought-container" layout:fragment="content">
  <!-- 왼쪽 사이드바 (mypage와 동일) -->
  <div th:replace="~{mypage/mypage :: sidebar}"></div>

  <!-- 메인 컨텐츠 -->
  <main class="bought-main">
    <h2>구매 내역 상세</h2>
    <div class="buy-detail">
      <!-- 상품 정보 영역 -->
      <div class="product-info">
        <!-- 왼쪽: 상품 정보 -->
        <div class="product-details">
          <p class="product-name"><strong>상품 이름:</strong> <span>상품 A</span></p>
          <p class="product-category"><strong>카테고리:</strong> <span>전자제품</span></p>
          <p class="register-time"><strong>주문 시간:</strong> <span>2025-02-05 14:30:00</span></p>
        </div>
        <!-- 오른쪽: 상품 이미지 -->
        <div class="product-image">
          <img src="/images/sample_product.jpg" alt="상품 이미지">
        </div>
      </div>

      <!-- 거래 정보 영역 -->
      <div class="transaction-info">
        <p class="seller"><strong>판매자:</strong> <span>판매자123</span></p>
        <p class="transaction-type"><strong>거래 방식:</strong> <span>즉시 구매</span></p>
        <p class="purchase-price"><strong>구매 가격:</strong> <span>50,000 원</span></p>
        <p class="complete-time"><strong>거래 완료 시간:</strong> <span>2025-02-06 16:45:00</span></p>

        <div class="tracking">
          <span class="tracking-label">운송장 정보:</span>
          <button class="tracking-btn not-loaded" onclick="loadTracking()">운송장 불러오기</button>
          <p class="tracking-number" style="display: none;">
            <strong>등록된 운송장 번호:</strong> <span id="trackingNo"></span>
          </p>
        </div>

        <!-- 운송장 및 거래 완료 영역 -->
        <div class="tracking-area">
          <button class="smartapi-btn" onclick="">배송 조회</button>
          <button class="complete-btn" onclick="completeTransaction()">거래 완료</button>
        </div>
      </div>
    </div>
  </main>
</div>

<script>
  // 임시 변수: 실제 환경에서는 백엔드 연동으로 등록된 운송장 번호를 가져옵니다.
  let registeredTracking = ""; // 예: "TRK123456789" 또는 빈 문자열

  function loadTracking() {
    if (registeredTracking.trim() !== "") {
      document.getElementById("trackingNo").textContent = registeredTracking;
      document.querySelector(".tracking-number").style.display = "block";
    } else {
      alert("운송장 정보가 등록되어 있지 않습니다.");
    }
  }

  function completeTransaction() {
    // 거래 완료 처리 로직 (백엔드 연동 필요)
    alert("거래 완료 처리되었습니다.");
  }
</script>

</body>
</html>
